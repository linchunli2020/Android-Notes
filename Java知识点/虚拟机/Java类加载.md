***前言***

一个 Java 文件从编码完成到最终执行，一般主要包括两个过程：

    （1）编译：即把我们写好的 Java 文件，通过javac命令编译成字节码，也就是我们常说的.class文件。
    （2）运行：把编译生成的.class文件交给 Java 虚拟机( JVM )执行。
    
**类加载过程**即是指 JVM 虚拟机把.class文件中类信息加载进内存，并进行解析生成对应的class对象的过程。

JVM 不是一开始就把所有的类都加载进内存中，而是只有第一次遇到某个需要运行的类时才会加载，且只加载一次。


***类加载***

类加载的过程主要分为以下个几个部分：

<img width="715" alt="image" src="https://user-images.githubusercontent.com/67937122/161373153-d9507f2d-3d95-4e43-9f89-d57c1e062dd3.png">

***（1）加载***

把class字节码文件从各个来源通过类加载器装载入内存中。

***（2）验证***

主要是为了保证加载进来的字节流符合虚拟机规范，不会造成安全错误。

包括：
      文件格式的验证
      元数据的验证
      字节码的验证
      符号引用的验证
      
***（3）准备***

主要是为类变量（静态变量，不是实例变量）分配内存，并且赋予初值（这个初值，不是代码中具体写的初始化的值，而是java虚拟机根据不同变量类型的默认初始值）。

***（4）解析***

将常量池内的符号引用替换为直接引用的过程。

符号引用：一个字符串，但是这个字符串给出了一些能够唯一标识一个方法，一个变量，一个类的相关信息。
直接引用：一个内存地址，或一个偏移量，比如类方法，类变量的直接引用是指向方法区的指针；而实例方法，实例变量的直接引用则是从实例的头指针开始算起到这个实例变量位置的偏移量。

***（5）初始化***

这个阶段主要是对类变量初始化，是执行类构造器的过程。

只对static修饰的变量或语句进行初始化。

如果初始化一个类的时候，其父类尚未初始化，则优先初始化其父类。

如果同时包含多个静态变量和静态代码块，则按照自上而下的顺序依次执行。



参考：https://cloud.tencent.com/developer/article/1628085


